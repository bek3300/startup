{% extends './base.html' %} 
{% block content %} {% load static %} 
{% include './header.html' %} {% comment %}
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"
></script>
{% endcomment %}
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"
></script>
<link
  rel="stylesheet"
  type="text/css"
  href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"
/>
<div class="breadcrumbs">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center">
      <h2>Network</h2>
      <ol>
        <li><a class="active" href="#" onclick="getContent('startups')">Startups</a></li>
        <li><a href="#" onclick="getContent('mentors')">Mentors</a></li>
        <li><a href="#" onclick="getContent('incubators')">Incubators</a></li>
        <li><a href="#" onclick="getContent('hubs')">Hubs</a></li>
        <li><a href="#" onclick="getContent('acclerators')">Acclerators</a></li>
        <li><a href="#" onclick="getContent('doners')">Doners</a></li>
        <li><a href="#" onclick="getContent('funder')">Funder</a></li>
        <li><a href="#" onclick="getContent('government')">Gov't Bodies</a></li>
      </ol>
    </div>
  </div>
</div>
<script>
  function getContent(typeOf){
    var getContentByName = '{% url 'main:get_content' 12345 %}';
  var url_mask = getContentByName.replace("12345", typeOf);
    $.ajax({
      
      url: url_mask,
      {% comment %} data: JSON.stringify(obj), {% endcomment %}
      dataType: 'html',
      type: "POST",
      success: function (data) {
        $('#filter_replace').replaceWith(data)
        console.log(data)
        
      },
      error: function (data) {
      }
    });
    
  }
</script>
<!-- End Breadcrumbs -->

<!-- ======= Blog Section ======= -->
<section id="blog" class="blog">
  <div class="container" data-aos="fade-up">
    <div class="row g-5" id="filter_replace">
      <div class="col-lg-3">
        

        <div class="sidebar" style="justify-content: center;display: grid;">
          <div class="sidebar-item search-form">
            <h3 class="sidebar-title">Filter</h3>
            <form action="" class="mt-3">
              <input type="text" />
              <button type="submit"><i class="bi bi-search"></i></button>
            </form>
          </div>
          <!-- End sidebar search formn-->

          <div class="sidebar-item categories">
            <form id="filterForm" style="justify-content: center;display: grid;" method="post">
              {% csrf_token %}
        
            <button type='submit' class="btn btn-primary"  id="filter">filter</button>
          </form>
        
          </div>
          <!-- End sidebar categories-->
        </div>
        <!-- End Blog Sidebar -->
      </div>
     

      <div class="col-lg-9" >
        <div class="row gy-12 posts-list" id="to_replaced">
          {% for mentor in mentors %}
          <div class="col-lg-4">
            <article class="d-flex flex-column">
              <h2 class="title">
                <img
                  src="{{mentor.profile.profile_pic.url}}"
                  alt=""
                  style="max-width: 50px"
                />&nbsp;
                <a href="blog-details.html">{{mentor.description.name}}</a>
              </h2>

              <div class="content">
                <p>{{mentor.description.description}}</p>
              </div>

              <div
                class="read-more mt-auto align-self-end"
                style="display: flex"
              >
                <button
                  class="btn btn-open"
                  data-name="{{startup.description.name}}"
                  data-description="{{startup.description.description}}"
                  data-sector="{{startup.description.sector }}=='Other'?{{startup.description.other_sector}}:{{startup.description.sector}}"
                  data-logo="{{startup.logo.url}}"
                  data-establishmentyear="{{startup.establishment_year}}"
                  data-marketscope="{{startup.market_scope}}"
                  data-stage="{{startup.stage}}"
                  data-country="{{startup.address.country}}"
                  data-region="{{startup.address.location.regionId.region_name}}"
                  data-wereda="{{startup.address.location.wereda_name}}"
                  data-phonenumber="{{startup.address.phone_number}}"
                  data-cityname="{{startup.address.city_name}}"
                  data-website="{{startup.address.website}}"
                  data-firstname="{{startup.profile.user.first_name}}"
                  data-middilename="{{startup.profile.middile_name}}"
                  data-lastname="{{startup.profile.user.last_name}}"
                  data-email="{{startup.profile.user.email}}"
                  data-gender="{{startup.profile.gender}}"
                  {%
                  comment
                  %}
                  data-connectedwith="{{startup.profile.fr}}"
                  {%
                  endcomment
                  %}
                  onclick="openModal(event)"
                >
                  Detail{{startup.is_connected}}
                </button>
                {%if user.is_authenticated %}
                <button class="btn btn-open">
                  <a
                    href="{% url 'main:freind_request' mentor.profile.user.id%}"
                    >Connect</a
                  ></button
                >{%endif%}
              </div>
            </article>
          </div>
          <!-- End post list item -->
          {%endfor%}
        </div>
        <!-- End blog posts list -->
      </div>
    </div>
  </div>
</section>
<!-- End Blog Section -->

<style>
  .accordion-button {
    border-radius: 4px !important;
  }

  .modal {
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 0.4rem;
    width: 450px;
    padding: 1.3rem;
    height: auto;
    /* position: absolute; */
    z-index: 2;
    left: 35%;
    top: 20%;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 15px;
  }

  .modal .flex {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .modal input {
    padding: 0.7rem 1rem;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 0.9em;
  }

  .modal p {
    font-size: 0.9rem;
    color: #777;
    margin: 0.4rem 0 0.2rem;
  }

  button {
    cursor: pointer;
    border: none;
    font-weight: 600;
  }

  .btn-close {
    transform: translate(10px, -20px);
    padding: 0.5rem 0.7rem;
    background: #eee;
    border-radius: 50%;
  }

  .overlay {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(1px);
    z-index: 1;
  }

  .hidden {
    display: none;
  }
  .flex img {
    max-width: 60px !important;
    border-radius: 50%;
    margin-left: 40%;
    margin-bottom: 20px;
  }
</style>
<section class="modal hidden">
  <div class="flex">
    <img src="assets/img/AII-logo.png" alt="user" />
    <button class="btn-close">â¨‰</button>
  </div>
  <div>
    <h3>Company Title</h3>
    <p>Sector:<span id="sect"></span></p>
    <p>Establishement year</p>
    <p>Stage</p>
    <p>Market Scope</p>
    <p>Description</p>
  </div>
</section>

<div class="overlay hidden"></div>

<script>
  const modal = document.querySelector(".modal");
  const overlay = document.querySelector(".overlay");
  const openModalBtn = document.querySelector(".btn-open");
  const closeModalBtn = document.querySelector(".btn-close");
  const closeModal = function () {
    modal.classList.add("hidden");
    overlay.classList.add("hidden");
  };
  closeModalBtn.addEventListener("click", closeModal);
  overlay.addEventListener("click", closeModal);
  document.addEventListener("keydown", function (e) {
    if (e.key === "Escape" && !modal.classList.contains("hidden")) {
      closeModal();
    }
  });
  const openModal = function (e) {
    
    $("#sect").text(e.target.dataset.sector);
    modal.classList.remove("hidden");
    overlay.classList.remove("hidden");
  };
</script>
<script>
  $(document).ready(function () {
    // $.validator.addMethod('confirmPass', function(value) {
    //   if($('#startup_password').val() == $('#startup_password2').val()){ return true; } return false;
    // }, "Password and confirm password fields do not match");
    // $("#startupForm").validate()
    // $("#connectForm").validate()
    jQuery("#connectForm").validate();
    $("#connectForm").submit(function (event) {
      event.preventDefault();
      const csrfmiddlewaretoken = document.querySelector(
        "[name=csrfmiddlewaretoken]"
      ).value;

      var fd = new FormData();
      fd.append("connect", $(".connect").attr("id"));

      $.ajax({
        headers: { "X-CSRFToken": csrfmiddlewaretoken },
        url: '{% url "main:connect" %}',
        data: fd,
        processData: false,
        contentType: false,
        type: "POST",
        success: function (data) {
          
        },
        error: function (data) {
        }
      });
    });
  });
</script>

{% endblock content %}
